<html ng-app="app">
<head>
    <link href="bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
    <link href="site.css" rel="stylesheet">

    <script src="bower_components/underscore/underscore.js"></script>
    <script src="bower_components/angular/angular.js"></script>
    <script src="bower_components/cryptojslib/rollups/aes.js"></script>

    <script src="app.js"></script>
</head>

<body class="container" ng-controller="ctrl">
    <div class="row">
        <div class="bg-success col-sm-12">
            <span class="h1">Dayary</span> - day by day
            <button class="btn btn-success pull-right" ng-click="settingsEdit = true">
                Settings
            </button>
        </div>

        <br />
        <br />

        <!-- TODO: introduce a state for data loading -->
        <div ng-hide="records">
            Data is loading...
        </div>

        <br />

        <div class="bg-danger" ng-show="error">
            Error: {{error}}
            <button type="button" class="close" ng-click="unsetError()">
                <span>&times;</span>
            </button>
        </div>

        <div ng-show="records" class="col-sm-3">
            <h2>Records</h2>

            <div>
                <button class="btn btn-success" ng-click="add()">
                    Add
                </button>
            </div>

            <br />

            <ul class="list-unstyled">
                <li ng-repeat="record in records"
                    ng-class="{ 'bg-success': (record.id == selected.id) }">

                    <a ng-click="select(record.id)" href="#">
                        {{record.created | date : 'yyyy-MM-dd'}}
                    </a>
                </li>
            </ul>
        </div>

        <div ng-show="!selected" class="bg-success">
            Looks like this is a fresh new diary. Start by hitting 'Add' to
            add a new record.
        </div>

        <div ng-show="selected"
             ng-class="{ 'col-sm-9' : !settingsEdit, 'col-sm-6': settingsEdit }">
            <h2>{{selected.created | date : 'fullDate'}}</h2>

            <div ng-hide="editing">
                <button class="btn btn-success"
                        ng-click="startEdit(selected)">
                    Edit
                </button>

                <span class="bg-success">
                    - last updated on
                    {{selected.updated | date : 'EEEE, MMMM d, y HH:mm:ss'}}
                </span>
            </div>

            <div ng-show="editing">
                <button class="btn btn-success"
                        ng-click="view(selected)">
                    View
                </button>

                <span class="bg-success"
                      ng-show="saved">
                    - {{saved}}
                </span>
            </div>

            <br />

            <p ng-hide="editing">
                <!-- TODO: split by paragraphs -->
                {{selected.text}}
            </p>

            <textarea ng-show="editing"
                      ng-model="selected.text" ng-trim="false"
                      rows=15 class="text-editor"
                      placeholder="Enter text here...">
            </textarea>
        </div>

        <div ng-show="settingsEdit" class="col-sm-3">
            <h2>Settings</h2>
            <div>
                <button class="btn btn-success" ng-click="settingsEdit = false">
                    Done
                </button>
            </div>

            <br />

            <div>Pass Phrase:</div>
            <input type="text" ng-model="passphrase" ng-trim="false">

            <br />
            <br />

            <div>Auto Save (sec):</div>
            <input type="number" ng-model="autosaveInterval">
        </div>
    </div>
<body>
</html>
